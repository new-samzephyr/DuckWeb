<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>No Time to Think</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f4;
        }
        #banner img {
            width: 100%;
            height: auto;
            object-fit: cover;
        }
        #topic {
            font-size: 24px;
            margin: 20px;
        }
        #timer {
            font-size: 20px;
            margin: 20px;
        }
        button {
            margin: 5px;
            padding: 10px 15px;
            font-size: 16px;
            cursor: pointer;
        }
        input[type="range"] {
            width: 300px;
        }
    </style>
</head>
<body>
    <div id="banner">
        <img src="NTTT.png" alt="Banner Image">
    </div>
    <div id="topic">Press Start to Begin</div>
    <div id="timer">20</div>
    
    <div>
        <input type="range" id="time-selector" min="10" max="30" step="10" value="20" onchange="updateTime()">
        <span id="selected-time">20</span> seconds (Recommended)
    </div>
    
    <button id="start-pause" onclick="startPauseGame()">Start</button>
    <button id="skip" onclick="skipTopic()">Skip</button>
    <button id="restart" onclick="restartGame()">Restart</button>

    <script>
        let topics = {};
        let timer;
        let timeLeft = 20; // Default to 20 seconds
        let currentTopicIndex = 0;
        let isPaused = false;
        let usedTopics = [];
        let skippedTopics = [];
        let engagementCount = { A1: 0, A2: 0, B1: 0, B2: 0, C1: 0, C2: 0 };
        let currentLevel = 'A1'; // Start with the easiest level

        // Fetch topics from JSON file
        fetch('NTTT-Topics.json')
            .then(response => response.json())
            .then(data => {
                topics = data;
                changeTopic(); // Start with the first topic
            })
            .catch(error => console.error('Error fetching topics:', error));

        function updateTimer() {
            if (isPaused) return;
            if (timeLeft <= 0) {
                changeTopic();
                timeLeft = parseInt(document.getElementById('time-selector').value); // Reset to selected time
            } else {
                timeLeft--;
                document.getElementById('timer').innerText = timeLeft;
            }
        }

        function startPauseGame() {
            const startPauseButton = document.getElementById('start-pause');
            if (!timer) {
                timer = setInterval(updateTimer, 1000);
                startPauseButton.innerText = 'Pause';
            } else if (isPaused) {
                isPaused = false;
                startPauseButton.innerText = 'Pause';
            } else {
                isPaused = true;
                startPauseButton.innerText = 'Continue';
            }
        }

        function restartGame() {
            clearInterval(timer);
            timer = null;
            timeLeft = parseInt(document.getElementById('time-selector').value); // Set initial time from slider
            currentTopicIndex = 0;
            isPaused = false;
            usedTopics = [];
            skippedTopics = [];
            engagementCount = { A1: 0, A2: 0, B1: 0, B2: 0, C1: 0, C2: 0 };
            document.getElementById('topic').innerText = 'Press Start to Begin';
            document.getElementById('timer').innerText = timeLeft;
            document.getElementById('start-pause').innerText = 'Start';
        }

        function changeTopic() {
            const levelTopics = topics[currentLevel];
            if (usedTopics.length === levelTopics.length) {
                usedTopics = []; // Reset if all topics used
            }
            let randomIndex;
            do {
                randomIndex = Math.floor(Math.random() * levelTopics.length);
            } while (usedTopics.includes(randomIndex));
            usedTopics.push(randomIndex);
            currentTopicIndex = randomIndex;
            document.getElementById('topic').innerText = levelTopics[currentTopicIndex].topic;
        }

        function skipTopic() {
            const levelTopics = topics[currentLevel];
            skippedTopics.push(levelTopics[currentTopicIndex].topic);
            adjustLevel('skip');
            changeTopic(); // Change to the next topic
        }

        function adjustLevel(action) {
            const levelTopics = topics[currentLevel];
            if (action === 'skip') {
                engagementCount[currentLevel]--;
            } else {
                engagementCount[currentLevel]++;
            }

            // Logic to adjust level based on engagement count
            if (engagementCount[currentLevel] < -2) {
                if (currentLevel === 'A1') return; // Already at the lowest level
                currentLevel = String.fromCharCode(currentLevel.charCodeAt(0) + 1); // Move to the next level
            } else if (engagementCount[currentLevel] > 2) {
                if (currentLevel === 'C2') return; // Already at the highest level
                currentLevel = String.fromCharCode(currentLevel.charCodeAt(0) - 1); // Move to the previous level
            }
        }

        function updateTime() {
            const timeSelector = document.getElementById('time-selector');
            timeLeft = parseInt(timeSelector.value); // Update timeLeft based on slider
            document.getElementById('selected-time').innerText = timeLeft; // Update display
        }
    </script>
</body>
</html>
